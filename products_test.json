#+ summary: "Retrieves all RO-Crates as products according to SKG-IF"
#+ description: "Retrieves all products according to SKG-IF. NOTE: make sure response content type is application/json"
#+ endpoint: "https://rohub2020-api-virtuoso-route-rohub.apps.paas-dev.psnc.pl/sparql"
#+ endpoint_in_url: False
{
  "@context": [
        "https://w3id.org/skg-if/context/skg-if.json",
        {
            "@base": "https://w3id.org/skg-if/sandbox/oc/",
            "skg": "https://w3id.org/skg-if/sandbox/oc/",
            "ro" : "http://purl.org/wf4ever/wf4ever#",
            "rocrate_researchObject": "http://purl.org/wf4ever/wf4ever#ResearchObject",
            "rocrate_copyright-owner": "http://purl.org/spar/pro/copyright-owner",
            "rocrate_hasPart": "http://schema.org/hasPart",
            "rocrate_email": "http://schema.org/email",
            "rocrate_w3id": "skg:w3id"
        }
  ],
  "@graph": [{    
    "entity_type": "product",
    "local_identifier": "?id$anchor",
    "identifiers": 
    {
        "scheme": "rocrate_w3id",
        "value": "?ro_id"
    },
    "titles": {
        "none": "?ro_title"
    },
    "abstracts":{
        "none": "?ro_desc"
    },
    "contributions": 
    {
        "by": "?author_id",
        "role": "author"
    },
    "rocrate_hasPart":{
        "@id": "?part_id"
    }
  }],
  "$where": [
    "?id a ro:ResearchObject",
    "?id dct:title ?ro_title",
    "?id dct:description ?ro_desc",
    "?id pav:authoredBy ?author_id",
    "?id ore:aggregates ?part_id",
    "BIND (CONCAT(\"ro-id/\",REPLACE(STR(?id), \"^.*/([^/]*)$\", \"$1\")) as ?ro_id)" 
  ],
  "$prefixes": {    
    "dct" : "http://purl.org/dc/terms/",
    "ro" : "http://purl.org/wf4ever/ro#",
    "pav": "http://purl.org/pav/",
    "ore": "http://www.openarchives.org/ore/terms/"
  },
  "$limit": 100
}